{"dependencies":[{"name":"./route","loc":{"line":16,"column":20}},{"name":"./layer","loc":{"line":17,"column":20}},{"name":"methods","loc":{"line":18,"column":22}},{"name":"utils-merge","loc":{"line":19,"column":20}},{"name":"debug","loc":{"line":20,"column":20}},{"name":"depd","loc":{"line":21,"column":24}},{"name":"array-flatten","loc":{"line":22,"column":22}},{"name":"parseurl","loc":{"line":23,"column":23}},{"name":"setprototypeof","loc":{"line":24,"column":29}}],"generated":{"js":"\"use strict\";var r=require(\"./route\"),e=require(\"./layer\"),t=require(\"methods\"),n=require(\"utils-merge\"),a=require(\"debug\")(\"express:router\"),i=require(\"depd\")(\"express\"),s=require(\"array-flatten\"),u=require(\"parseurl\"),o=require(\"setprototypeof\"),l=/^\\[object (\\S+)\\]$/,f=Array.prototype.slice,c=Object.prototype.toString,h=module.exports=function(r){var e=r||{};function t(r,e,n){t.handle(r,e,n)}return o(t,h),t.params={},t._params=[],t.caseSensitive=e.caseSensitive,t.mergeParams=e.mergeParams,t.strict=e.strict,t.stack=[],t};function p(r,e){for(var t=0;t<e.length;t++){var n=e[t];-1===r.indexOf(n)&&r.push(n)}}function m(r){try{return u(r).pathname}catch(r){return}}function v(r){if(\"string\"==typeof r&&0!==r.length&&\"/\"!==r[0]){var e=r.indexOf(\"?\"),t=-1!==e?e:r.length,n=r.substr(0,t).indexOf(\"://\");return-1!==n?r.substr(0,r.indexOf(\"/\",3+n)):void 0}}function g(r){var e=typeof r;return\"object\"!==e?e:c.call(r).replace(l,\"$1\")}function d(r,e){try{return r.match(e)}catch(r){return r}}function y(r,e){if(\"object\"!=typeof e||!e)return r;var t=n({},e);if(!(0 in r&&0 in e))return n(t,r);for(var a=0,i=0;a in r;)a++;for(;i in e;)i++;for(a--;a>=0;a--)r[a+i]=r[a],a<i&&delete r[a];return n(t,r)}function b(r,e){for(var t=new Array(arguments.length-2),n=new Array(arguments.length-2),a=0;a<t.length;a++)t[a]=arguments[a+2],n[a]=e[t[a]];return function(){for(var a=0;a<t.length;a++)e[t[a]]=n[a];return r.apply(this,arguments)}}function w(r,e,t){try{var n=e.join(\",\");r.set(\"Allow\",n),r.send(n)}catch(r){t(r)}}function q(r,e){return function(){var t=new Array(arguments.length+1);t[0]=r;for(var n=0,a=arguments.length;n<a;n++)t[n+1]=arguments[n];e.apply(this,t)}}h.param=function(r,e){if(\"function\"==typeof r)return i(\"router.param(fn): Refactor to use path params\"),void this._params.push(r);var t,n=this._params,a=n.length;\":\"===r[0]&&(i(\"router.param(\"+JSON.stringify(r)+\", fn): Use router.param(\"+JSON.stringify(r.substr(1))+\", fn) instead\"),r=r.substr(1));for(var s=0;s<a;++s)(t=n[s](r,e))&&(e=t);if(\"function\"!=typeof e)throw new Error(\"invalid param() call for \"+r+\", got \"+e);return(this.params[r]=this.params[r]||[]).push(e),this},h.handle=function(r,e,t){var n=this;a(\"dispatching %s %s\",r.method,r.url);var i=0,s=v(r.url)||\"\",u=\"\",o=!1,l={},f=[],c=n.stack,h=r.params,g=r.baseUrl||\"\",O=b(t,r,\"baseUrl\",\"next\",\"params\");function _(t){var v=\"route\"===t?null:t;if(o&&(r.url=r.url.substr(1),o=!1),0!==u.length&&(r.baseUrl=g,r.url=s+u+r.url.substr(s.length),u=\"\"),\"router\"!==v)if(i>=c.length)setImmediate(O,v);else{var b,w,q,x=m(r);if(null==x)return O(v);for(;!0!==w&&i<c.length;)if(w=d(b=c[i++],x),q=b.route,\"boolean\"!=typeof w&&(v=v||w),!0===w&&q)if(v)w=!1;else{var S=r.method,U=q._handles_method(S);U||\"OPTIONS\"!==S||p(f,q._options()),U||\"HEAD\"===S||(w=!1)}if(!0!==w)return O(v);q&&(r.route=q),r.params=n.mergeParams?y(b.params,h):b.params;var A=b.path;n.process_params(b,l,r,e,function(t){return t?_(v||t):q?b.handle_request(r,e,_):void function(t,n,i,l){if(0!==i.length){var f=l[i.length];if(f&&\"/\"!==f&&\".\"!==f)return _(n);a(\"trim prefix (%s) from url %s\",i,r.url),u=i,r.url=s+r.url.substr(s.length+u.length),s||\"/\"===r.url[0]||(r.url=\"/\"+r.url,o=!0),r.baseUrl=g+(\"/\"===u[u.length-1]?u.substring(0,u.length-1):u)}a(\"%s %s : %s\",t.name,i,r.originalUrl),n?t.handle_error(n,r,e,_):t.handle_request(r,e,_)}(b,v,A,x)})}else setImmediate(O,null)}r.next=_,\"OPTIONS\"===r.method&&(O=q(O,function(r,t){if(t||0===f.length)return r(t);w(e,f,r)})),r.baseUrl=g,r.originalUrl=r.originalUrl||r.url,_()},h.process_params=function(r,e,t,n,a){var i=this.params,s=r.keys;if(!s||0===s.length)return a();var u,o,l,f,c,h=0,p=0;function m(r){return r?a(r):h>=s.length?a():(p=0,o=s[h++],u=o.name,l=t.params[u],f=i[u],c=e[u],void 0!==l&&f?c&&(c.match===l||c.error&&\"route\"!==c.error)?(t.params[u]=c.value,m(c.error)):(e[u]=c={error:null,match:l,value:l},void v()):m())}function v(r){var e=f[p++];if(c.value=t.params[o.name],r)return c.error=r,void m(r);if(!e)return m();try{e(t,n,v,l,o.name)}catch(r){v(r)}}m()},h.use=function(r){var t=0,n=\"/\";if(\"function\"!=typeof r){for(var i=r;Array.isArray(i)&&0!==i.length;)i=i[0];\"function\"!=typeof i&&(t=1,n=r)}var u=s(f.call(arguments,t));if(0===u.length)throw new TypeError(\"Router.use() requires a middleware function\");for(var o=0;o<u.length;o++){if(\"function\"!=typeof(r=u[o]))throw new TypeError(\"Router.use() requires a middleware function but got a \"+g(r));a(\"use %o %s\",n,r.name||\"<anonymous>\");var l=new e(n,{sensitive:this.caseSensitive,strict:!1,end:!1},r);l.route=void 0,this.stack.push(l)}return this},h.route=function(t){var n=new r(t),a=new e(t,{sensitive:this.caseSensitive,strict:this.strict,end:!0},n.dispatch.bind(n));return a.route=n,this.stack.push(a),n},t.concat(\"all\").forEach(function(r){h[r]=function(e){var t=this.route(e);return t[r].apply(t,f.call(arguments,1)),this}});"},"hash":"482980d247fc96cbcbcf6e9949e7d8b9"}