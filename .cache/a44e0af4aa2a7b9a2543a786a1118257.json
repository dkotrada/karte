{"dependencies":[{"name":"safe-buffer","loc":{"line":15,"column":21}},{"name":"content-disposition","loc":{"line":16,"column":33}},{"name":"depd","loc":{"line":17,"column":24}},{"name":"encodeurl","loc":{"line":18,"column":24}},{"name":"escape-html","loc":{"line":19,"column":25}},{"name":"http","loc":{"line":20,"column":19}},{"name":"./utils","loc":{"line":29,"column":25}},{"name":"on-finished","loc":{"line":22,"column":25}},{"name":"path","loc":{"line":23,"column":19}},{"name":"statuses","loc":{"line":24,"column":23}},{"name":"utils-merge","loc":{"line":25,"column":20}},{"name":"cookie-signature","loc":{"line":26,"column":19}},{"name":"cookie","loc":{"line":30,"column":21}},{"name":"send","loc":{"line":31,"column":19}},{"name":"vary","loc":{"line":35,"column":19}}],"generated":{"js":"\n\"use strict\";var e=require(\"safe-buffer\").Buffer,t=require(\"content-disposition\"),s=require(\"depd\")(\"express\"),n=require(\"encodeurl\"),r=require(\"escape-html\"),i=require(\"http\"),o=require(\"./utils\").isAbsolute,a=require(\"on-finished\"),u=require(\"path\"),h=require(\"statuses\"),c=require(\"utils-merge\"),f=require(\"cookie-signature\").sign,d=require(\"./utils\").normalizeType,p=require(\"./utils\").normalizeTypes,l=require(\"./utils\").setCharset,y=require(\"cookie\"),g=require(\"send\"),v=u.extname,C=g.mime,b=u.resolve,j=require(\"vary\"),m=Object.create(i.ServerResponse.prototype);module.exports=m;var q=/;\\s*charset\\s*=/;function T(e,t,s,n){var r,i=!1;function o(){if(!i){i=!0;var e=new Error(\"Request aborted\");e.code=\"ECONNABORTED\",n(e)}}function u(e){i||(i=!0,n(e))}t.on(\"directory\",function(){if(!i){i=!0;var e=new Error(\"EISDIR, read\");e.code=\"EISDIR\",n(e)}}),t.on(\"end\",function(){i||(i=!0,n())}),t.on(\"error\",u),t.on(\"file\",function(){r=!1}),t.on(\"stream\",function(){r=!0}),a(e,function(e){return e&&\"ECONNRESET\"===e.code?o():e?u(e):void(i||setImmediate(function(){!1===r||i?i||(i=!0,n()):o()}))}),s.headers&&t.on(\"headers\",function(e){for(var t=s.headers,n=Object.keys(t),r=0;r<n.length;r++){var i=n[r];e.setHeader(i,t[i])}}),t.pipe(e)}function A(e,t,s,n){var r=t||s?JSON.stringify(e,t,s):JSON.stringify(e);return n&&(r=r.replace(/[<>&]/g,function(e){switch(e.charCodeAt(0)){case 60:return\"\\\\u003c\";case 62:return\"\\\\u003e\";case 38:return\"\\\\u0026\";default:return e}})),r}m.status=function(e){return this.statusCode=e,this},m.links=function(e){var t=this.get(\"Link\")||\"\";return t&&(t+=\", \"),this.set(\"Link\",t+Object.keys(e).map(function(t){return\"<\"+e[t]+'>; rel=\"'+t+'\"'}).join(\", \"))},m.send=function(t){var n,r,i=t,o=this.req,a=this.app;switch(2===arguments.length&&(\"number\"!=typeof arguments[0]&&\"number\"==typeof arguments[1]?(s(\"res.send(body, status): Use res.status(status).send(body) instead\"),this.statusCode=arguments[1]):(s(\"res.send(status, body): Use res.status(status).send(body) instead\"),this.statusCode=arguments[0],i=arguments[1])),\"number\"==typeof i&&1===arguments.length&&(this.get(\"Content-Type\")||this.type(\"txt\"),s(\"res.send(status): Use res.sendStatus(status) instead\"),this.statusCode=i,i=h[i]),typeof i){case\"string\":this.get(\"Content-Type\")||this.type(\"html\");break;case\"boolean\":case\"number\":case\"object\":if(null===i)i=\"\";else{if(!e.isBuffer(i))return this.json(i);this.get(\"Content-Type\")||this.type(\"bin\")}}\"string\"==typeof i&&(n=\"utf8\",\"string\"==typeof(r=this.get(\"Content-Type\"))&&this.set(\"Content-Type\",l(r,\"utf-8\")));var u,c,f=a.get(\"etag fn\"),d=!this.get(\"ETag\")&&\"function\"==typeof f;return void 0!==i&&(e.isBuffer(i)?u=i.length:!d&&i.length<1e3?u=e.byteLength(i,n):(i=e.from(i,n),n=void 0,u=i.length),this.set(\"Content-Length\",u)),d&&void 0!==u&&(c=f(i,n))&&this.set(\"ETag\",c),o.fresh&&(this.statusCode=304),204!==this.statusCode&&304!==this.statusCode||(this.removeHeader(\"Content-Type\"),this.removeHeader(\"Content-Length\"),this.removeHeader(\"Transfer-Encoding\"),i=\"\"),\"HEAD\"===o.method?this.end():this.end(i,n),this},m.json=function(e){var t=e;2===arguments.length&&(\"number\"==typeof arguments[1]?(s(\"res.json(obj, status): Use res.status(status).json(obj) instead\"),this.statusCode=arguments[1]):(s(\"res.json(status, obj): Use res.status(status).json(obj) instead\"),this.statusCode=arguments[0],t=arguments[1]));var n=this.app,r=n.get(\"json escape\"),i=A(t,n.get(\"json replacer\"),n.get(\"json spaces\"),r);return this.get(\"Content-Type\")||this.set(\"Content-Type\",\"application/json\"),this.send(i)},m.jsonp=function(e){var t=e;2===arguments.length&&(\"number\"==typeof arguments[1]?(s(\"res.jsonp(obj, status): Use res.status(status).json(obj) instead\"),this.statusCode=arguments[1]):(s(\"res.jsonp(status, obj): Use res.status(status).jsonp(obj) instead\"),this.statusCode=arguments[0],t=arguments[1]));var n=this.app,r=n.get(\"json escape\"),i=A(t,n.get(\"json replacer\"),n.get(\"json spaces\"),r),o=this.req.query[n.get(\"jsonp callback name\")];return this.get(\"Content-Type\")||(this.set(\"X-Content-Type-Options\",\"nosniff\"),this.set(\"Content-Type\",\"application/json\")),Array.isArray(o)&&(o=o[0]),\"string\"==typeof o&&0!==o.length&&(this.set(\"X-Content-Type-Options\",\"nosniff\"),this.set(\"Content-Type\",\"text/javascript\"),i=\"/**/ typeof \"+(o=o.replace(/[^\\[\\]\\w$.]/g,\"\"))+\" === 'function' && \"+o+\"(\"+(i=i.replace(/\\u2028/g,\"\\\\u2028\").replace(/\\u2029/g,\"\\\\u2029\"))+\");\"),this.send(i)},m.sendStatus=function(e){var t=h[e]||String(e);return this.statusCode=e,this.type(\"txt\"),this.send(t)},m.sendFile=function(e,t,s){var n=s,r=this.req,i=r.next,a=t||{};if(!e)throw new TypeError(\"path argument is required to res.sendFile\");if(\"function\"==typeof t&&(n=t,a={}),!a.root&&!o(e))throw new TypeError(\"path must be absolute or specify root to res.sendFile\");var u=encodeURI(e);T(this,g(r,u,a),a,function(e){return n?n(e):e&&\"EISDIR\"===e.code?i():void(e&&\"ECONNABORTED\"!==e.code&&\"write\"!==e.syscall&&i(e))})},m.sendfile=function(e,t,s){var n=s,r=this.req,i=r.next,o=t||{};\"function\"==typeof t&&(n=t,o={}),T(this,g(r,e,o),o,function(e){return n?n(e):e&&\"EISDIR\"===e.code?i():void(e&&\"ECONNABORT\"!==e.code&&\"write\"!==e.syscall&&i(e))})},m.sendfile=s.function(m.sendfile,\"res.sendfile: Use res.sendFile instead\"),m.download=function(e,s,n,r){var i=r,o=s,a=n||null;\"function\"==typeof s?(i=s,o=null,a=null):\"function\"==typeof n&&(i=n,a=null);var u={\"Content-Disposition\":t(o||e)};if(a&&a.headers)for(var h=Object.keys(a.headers),c=0;c<h.length;c++){var f=h[c];\"content-disposition\"!==f.toLowerCase()&&(u[f]=a.headers[f])}(a=Object.create(a)).headers=u;var d=b(e);return this.sendFile(d,a,i)},m.contentType=m.type=function(e){var t=-1===e.indexOf(\"/\")?C.lookup(e):e;return this.set(\"Content-Type\",t)},m.format=function(e){var t=this.req,s=t.next,n=e.default;n&&delete e.default;var r=Object.keys(e),i=r.length>0&&t.accepts(r);if(this.vary(\"Accept\"),i)this.set(\"Content-Type\",d(i).value),e[i](t,this,s);else if(n)n();else{var o=new Error(\"Not Acceptable\");o.status=o.statusCode=406,o.types=p(r).map(function(e){return e.value}),s(o)}return this},m.attachment=function(e){return e&&this.type(v(e)),this.set(\"Content-Disposition\",t(e)),this},m.append=function(e,t){var s=this.get(e),n=t;return s&&(n=Array.isArray(s)?s.concat(t):Array.isArray(t)?[s].concat(t):[s,t]),this.set(e,n)},m.set=m.header=function(e,t){if(2===arguments.length){var s=Array.isArray(t)?t.map(String):String(t);if(\"content-type\"===e.toLowerCase()){if(Array.isArray(s))throw new TypeError(\"Content-Type cannot be set to an Array\");if(!q.test(s)){var n=C.charsets.lookup(s.split(\";\")[0]);n&&(s+=\"; charset=\"+n.toLowerCase())}}this.setHeader(e,s)}else for(var r in e)this.set(r,e[r]);return this},m.get=function(e){return this.getHeader(e)},m.clearCookie=function(e,t){var s=c({expires:new Date(1),path:\"/\"},t);return this.cookie(e,\"\",s)},m.cookie=function(e,t,s){var n=c({},s),r=this.req.secret,i=n.signed;if(i&&!r)throw new Error('cookieParser(\"secret\") required for signed cookies');var o=\"object\"==typeof t?\"j:\"+JSON.stringify(t):String(t);return i&&(o=\"s:\"+f(o,r)),\"maxAge\"in n&&(n.expires=new Date(Date.now()+n.maxAge),n.maxAge/=1e3),null==n.path&&(n.path=\"/\"),this.append(\"Set-Cookie\",y.serialize(e,String(o),n)),this},m.location=function(e){var t=e;return\"back\"===e&&(t=this.req.get(\"Referrer\")||\"/\"),this.set(\"Location\",n(t))},m.redirect=function(t){var n,i=t,o=302;2===arguments.length&&(\"number\"==typeof arguments[0]?(o=arguments[0],i=arguments[1]):(s(\"res.redirect(url, status): Use res.redirect(status, url) instead\"),o=arguments[1])),i=this.location(i).get(\"Location\"),this.format({text:function(){n=h[o]+\". Redirecting to \"+i},html:function(){var e=r(i);n=\"<p>\"+h[o]+'. Redirecting to <a href=\"'+e+'\">'+e+\"</a></p>\"},default:function(){n=\"\"}}),this.statusCode=o,this.set(\"Content-Length\",e.byteLength(n)),\"HEAD\"===this.req.method?this.end():this.end(n)},m.vary=function(e){return!e||Array.isArray(e)&&!e.length?(s(\"res.vary(): Provide a field name\"),this):(j(this,e),this)},m.render=function(e,t,s){var n=this.req.app,r=s,i=t||{},o=this.req,a=this;\"function\"==typeof t&&(r=t,i={}),i._locals=a.locals,r=r||function(e,t){if(e)return o.next(e);a.send(t)},n.render(e,i,r)};"},"hash":"56e1f9ce3905d72755a16186413a96de"}