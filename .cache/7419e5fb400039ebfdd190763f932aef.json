{"dependencies":[{"name":"parse-asn1","loc":{"line":1,"column":24}},{"name":"./mgf","loc":{"line":2,"column":18}},{"name":"./xor","loc":{"line":3,"column":18}},{"name":"bn.js","loc":{"line":4,"column":17}},{"name":"browserify-rsa","loc":{"line":5,"column":18}},{"name":"create-hash","loc":{"line":6,"column":25}},{"name":"./withPublic","loc":{"line":7,"column":25}},{"name":"buffer"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar r=require(\"buffer\").Buffer,e=require(\"parse-asn1\"),n=require(\"./mgf\"),t=require(\"./xor\"),i=require(\"bn.js\"),o=require(\"browserify-rsa\"),u=require(\"create-hash\"),l=require(\"./withPublic\");function h(e,i){e.modulus;var o=e.modulus.byteLength(),l=(i.length,u(\"sha1\").update(new r(\"\")).digest()),h=l.length;if(0!==i[0])throw new Error(\"decryption error\");var a=i.slice(1,h+1),c=i.slice(h+1),s=t(a,n(c,h)),w=t(c,n(s,o-h-1));if(f(l,w.slice(0,h)))throw new Error(\"decryption error\");for(var g=h;0===w[g];)g++;if(1!==w[g++])throw new Error(\"decryption error\");return w.slice(g)}function a(r,e,n){for(var t=e.slice(0,2),i=2,o=0;0!==e[i++];)if(i>=e.length){o++;break}var u=e.slice(2,i-1);e.slice(i-1,i);if((\"0002\"!==t.toString(\"hex\")&&!n||\"0001\"!==t.toString(\"hex\")&&n)&&o++,u.length<8&&o++,o)throw new Error(\"decryption error\");return e.slice(i)}function f(e,n){e=new r(e),n=new r(n);var t=0,i=e.length;e.length!==n.length&&(t++,i=Math.min(e.length,n.length));for(var o=-1;++o<i;)t+=e[o]^n[o];return t}module.exports=function(n,t,u){var f;f=n.padding?n.padding:u?1:4;var c,s=e(n),w=s.modulus.byteLength();if(t.length>w||new i(t).cmp(s.modulus)>=0)throw new Error(\"decryption error\");c=u?l(new i(t),s):o(t,s);var g=new r(w-c.length);if(g.fill(0),c=r.concat([g,c],w),4===f)return h(s,c);if(1===f)return a(s,c,u);if(3===f)return c;throw new Error(\"unknown padding\")};"},"hash":"68e001d6715875d72ad81a9b21750e49"}