{"dependencies":[{"name":"create-hmac","loc":{"line":2,"column":25}},{"name":"browserify-rsa","loc":{"line":3,"column":18}},{"name":"elliptic","loc":{"line":4,"column":17}},{"name":"bn.js","loc":{"line":5,"column":17}},{"name":"parse-asn1","loc":{"line":6,"column":24}},{"name":"./curves.json","loc":{"line":7,"column":21}},{"name":"buffer"}],"generated":{"js":"var Buffer = require(\"buffer\").Buffer;\nvar e=require(\"buffer\").Buffer,r=require(\"create-hmac\"),t=require(\"browserify-rsa\"),n=require(\"elliptic\").ec,a=require(\"bn.js\"),u=require(\"parse-asn1\"),o=require(\"./curves.json\");function i(r,n,a,o,i){var c=u(n);if(c.curve){if(\"ecdsa\"!==o&&\"ecdsa/rsa\"!==o)throw new Error(\"wrong private key type\");return d(r,c)}if(\"dsa\"===c.type){if(\"dsa\"!==o)throw new Error(\"wrong private key type\");return p(r,c,a)}if(\"rsa\"!==o&&\"ecdsa/rsa\"!==o)throw new Error(\"wrong private key type\");r=e.concat([i,r]);for(var s=c.modulus.byteLength(),g=[0,1];r.length+g.length+1<s;)g.push(255);g.push(0);for(var v=-1;++v<r.length;)g.push(r[v]);return t(g,c)}function d(r,t){var a=o[t.curve.join(\".\")];if(!a)throw new Error(\"unknown curve \"+t.curve.join(\".\"));var u=new n(a).keyFromPrivate(t.privateKey).sign(r);return new e(u.toDER())}function p(e,r,t){for(var n,u=r.params.priv_key,o=r.params.p,i=r.params.q,d=r.params.g,p=new a(0),v=g(e,i).mod(i),l=!1,w=s(u,i,e,t);!1===l;)p=h(d,n=f(i,w,t),o,i),0===(l=n.invm(i).imul(v.add(u.mul(p))).mod(i)).cmpn(0)&&(l=!1,p=new a(0));return c(p,l)}function c(r,t){r=r.toArray(),t=t.toArray(),128&r[0]&&(r=[0].concat(r)),128&t[0]&&(t=[0].concat(t));var n=[48,r.length+t.length+4,2,r.length];return n=n.concat(r,[2,t.length],t),new e(n)}function s(t,n,a,u){if((t=new e(t.toArray())).length<n.byteLength()){var o=new e(n.byteLength()-t.length);o.fill(0),t=e.concat([o,t])}var i=a.length,d=v(a,n),p=new e(i);p.fill(1);var c=new e(i);return c.fill(0),c=r(u,c).update(p).update(new e([0])).update(t).update(d).digest(),p=r(u,c).update(p).digest(),{k:c=r(u,c).update(p).update(new e([1])).update(t).update(d).digest(),v:p=r(u,c).update(p).digest()}}function g(e,r){var t=new a(e),n=(e.length<<3)-r.bitLength();return n>0&&t.ishrn(n),t}function v(r,t){r=(r=g(r,t)).mod(t);var n=new e(r.toArray());if(n.length<t.byteLength()){var a=new e(t.byteLength()-n.length);a.fill(0),n=e.concat([a,n])}return n}function f(t,n,a){var u,o;do{for(u=new e(0);8*u.length<t.bitLength();)n.v=r(a,n.k).update(n.v).digest(),u=e.concat([u,n.v]);o=g(u,t),n.k=r(a,n.k).update(n.v).update(new e([0])).digest(),n.v=r(a,n.k).update(n.v).digest()}while(-1!==o.cmp(t));return o}function h(e,r,t,n){return e.toRed(a.mont(t)).redPow(r).fromRed().mod(n)}module.exports=i,module.exports.getKey=s,module.exports.makeKey=f;"},"hash":"1b10bc63fa292fc6b8b4c39a600f0c35"}